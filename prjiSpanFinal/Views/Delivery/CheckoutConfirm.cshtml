@model prjiSpanFinal.ViewModels.Delivery.CDeliveryCheckoutViewModel
@{
    ViewData["Title"] = "CheckoutConfirm";
    Dictionary<int, string> sellerDic = new Dictionary<int, string>();

    foreach (var i in Model.purchaseItemInfo)
    {
        if (sellerDic.ContainsKey(i.sellerID))
        {
            continue;
        }
        else
        {
            sellerDic.Add(i.sellerID, i.sellerAcc);
        }
    }
    List<int> sellerIDList = sellerDic.Keys.ToList();
}

@section Styles{
    <link href="~/css/Delivery/ProgressBar.css" rel="stylesheet" />
    <link href="~/css/Delivery/DeliveryCheckoutConfirm.css" rel="stylesheet" />
}

@await Component.InvokeAsync("DeliveryProgressBar", new { checkoutPage = 2 })

<div class="layout border rounded-2">
    @{
        foreach (var sellerID in sellerIDList)
        {
            <div class="sellerLayout">
                <div class="fs-3 fw-bold mx-2">@sellerDic[sellerID]<span class="fs-5">的賣場</span></div>
            </div>
            foreach (var i in Model.purchaseItemInfo)
            {
                if (i.sellerID == sellerID)
                {
                    string imgSrc = "";
                    try
                    {
                        string base64 = Convert.ToBase64String(i.productDetailPic);
                        imgSrc = $"data:image/gif;base64,{base64}";
                    }
                    catch
                    {
                        imgSrc = Url.Content("~/img/imageNotFound.png");
                    }
                    <div class="itemLayout d-flex justify-content-between align-items-center border-bottom ">
                        <div class="d-flex justify-content-start align-items-center w-75">
                            <div class="imgDiv">
                                <img src="@imgSrc" class="productDetailImg"/>
                            </div>
                            <div>
                                <div>@i.productName</div>
                                <div>@i.productStyle</div>
                                <div>$<span>@i.unitPrice</span></div>

                            </div>
                        </div>
                        <div class="w-25">
                            <div>@i.purchaseCount</div>
                        </div>
                    </div>
                }
            }
        }
    }

    <a href="@Url.Content("~/Delivery/OrderSuccess")"><button class="btn btn-warning">確認</button></a>
</div>

@section Scripts{
    <script src="~/js/Delivery/ProgressBar.js"></script>
}